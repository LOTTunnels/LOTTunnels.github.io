<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Staqlab | LOTTunnels</title>
    <link rel="icon" href="/assets/favicon.png">
    <link rel="stylesheet" href="/assets/style.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <script async defer src="https://buttons.github.io/buttons.js"></script><meta name="title" content="Staqlab on LOTTunnels">
    <meta name="description" content="StaqLab is a living-off-the-tunnels file containing unexpected functionality that can be abused by attackers; this page lists all its use cases.">
    <meta property="og:title" name="og:title" content="Staqlab on LOTTunnels">
    <meta property="og:site_name" name="og:site_name" content="LOTTunnels">
    <meta property="og:type" name="og:type" content="object">
    <meta property="og:url" name="og:url" content="http://localhost:4000/lottunnels/Binaries/staqlab/">
    <meta property="og:image" name="og:image" content="http://localhost:4000/assets/favicon.png">
    <meta property="og:description" name="og:description" content="StaqLab is a living-of-the-tunnels file containing unexpected functionality that can be abused by attackers; this page lists all its use cases.">
</head>
<body>
    <a href="https://github.com/LOTTunnels/LOTTunnels.github.io" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    	<h1><a href="/">..</a> /StaqLab<div class="github-buttons">
        <a class="github-button" href="https://github.com/LOTTunnels/LOTTunnels.github.io" data-icon="octicon-star" data-show-count="true" aria-label="Star LOTTunnels/LOTTunnels.github.io on GitHub">Star</a>
    </div>
</h1>

	<div class="function-list"><div><a href="/lottunnels/Binaries/staqlab/#access">Access</a></div><div><a href="/lottunnels/Binaries/staqlab/#exfiltrate">Exfiltration</a></div><div><a href="/lottunnels/Binaries/staqlab/#phishing">Phishing</a></div></div>

	<p>Staqlab enables insider threats and threat actors to create fake account on the website as there is no validation for account registration. In the Domains Section, threat actors can define dedicated tunnels subdomain name. Using the token for the authorization on the local system will enable them to connect to dynamically generated domains or else specified domains.</p>


	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-133649096-1"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'UA-133649096-1');
	</script>

	<script src="/assets/url_helper.js"></script>
	<section>
		<h3>Paths:</h3>
		<ul style="list-style-type:none">
			<li data-file-path>Downloaded version of Staqlab-tunnels.exe, which gets executed anywhere on the system.</li>
		</ul>
	</section>
	
	<section>
		<h3>Acknowledgements:</h3>
		<ul>
			<li>Kamran Saifullah (<a href="https://twitter.com/@deFr0ggy">@deFr0ggy</a>)</li>
		</ul>
	</section>
	
	<section>
		<h3>Detections:</h3>
		<ul>
			<li>Domain: <a href="*.tunnel.staqlab.com" target="_blank" data-shorten="true">*.tunnel.staqlab.com</a></li>
			<li>Domain: <a href="https://tunnel.staqlab.com/inspector/<4 Digits>/inspector" target="_blank" data-shorten="true">https://tunnel.staqlab.com/inspector/<4 Digits>/inspector</a></li>
			<li>Domain: <a href="*.staqlab-tunnel.com" target="_blank" data-shorten="true">*.staqlab-tunnel.com</a></li>
			<li>Command: <a href="Execution of the binary and/or with arguments." target="_blank" data-shorten="true">Execution of the binary and/or with arguments.</a></li>
		</ul>
	</section>

	<section>
		<h2 id="access" class="function-name">Access</h2>
		<ol>
			<li>
				<p>This will register the local staqlab-tunnel.exe with the registered account.</p>
				<pre><code>staqlab-tunnel.exe token=&lt;AUTH TOKEN&gt;</code></pre>
				<div class="properties">
					<dl class="row"><dt class="property">Use case</dt><dd>Authenticating, generating and accessing the URL.</dd></dl>
					<dl class="row"><dt class="property">Privileges required</dt><dd>User</dd></dl>
					<dl class="row"><dt class="property">Operating systems</dt><dd>Windows, Mac, Linux, Raspberry Pi</dd></dl>
				</div>
			</li>
		</ol>
		<h2 id="exfiltrate" class="function-name">Exfiltration</h2>
		<ol>
			<li>
				<p>This will create a tunnel to the port defined.</p>
				<pre><code>staqlab-tunnel.exe port=&lt;PORT&gt;</code></pre>
				<div class="properties">
					<dl class="row"><dt class="property">Use case</dt><dd>Exposing the local server running on local port over dynamic Staqlab Tunnels.</dd></dl>
					<dl class="row"><dt class="property">Privileges required</dt><dd>User</dd></dl>
					<dl class="row"><dt class="property">Operating systems</dt><dd>Windows, Mac, Linux, Raspberry Pi</dd></dl>
				</div>
			</li>
		</ol>
		<h2 id="phishing" class="function-name">Phishing</h2>
		<ol>
			<li>
				<p>Exposing the local server running on local port over Staqlab Tunnels having static domain names defined in the dashboard. This can be used in Phishing Campaigns. However, the dynamically generated links can also be used for the same purpose.</p>
				<pre><code>staqlab-tunnel.exe port=&lt;PORT&gt; domain=&lt;DOMAIN&gt;</code></pre>
				<div class="properties">
					<dl class="row"><dt class="property">Use case</dt><dd>Exposing the local server running on local port over static Staqlab Tunnels.</dd></dl>
					<dl class="row"><dt class="property">Privileges required</dt><dd>User</dd></dl>
					<dl class="row"><dt class="property">Operating systems</dt><dd>Windows, Mac, Linux, Raspberry Pi</dd></dl>
				</div>
			</li>
		</ol>
	</section>

    <script>
        // add permalink on headings
        document.querySelectorAll('h2').forEach((heading) => {
            const link = document.createElement('a');
            link.className = 'permalink';
            link.href = `#${heading.id}`;
            heading.appendChild(link);
        });
    </script>
</body>
</html>
